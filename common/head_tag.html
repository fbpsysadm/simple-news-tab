<script type="text/discourse-plugin" version="0.8.42">
  console.log("[News Tab Theme] Script loaded");
  // Add a new News tab to the navigation bar, linking to /top#news
  api.addNavigationBarItem({
    name: "news",
    displayName: "News",
    href: "/top#news"
  });

  // Function to show/hide news content and topic list
  function toggleNewsContent() {
    console.log("[News Tab Theme] toggleNewsContent called");
    const topicList = document.querySelector('.topic-list');
    const listArea = document.querySelector('#list-area');

    const topTab = document.querySelector('.nav-item_top');
    if (topTab) {
      topTab.style.display = 'none';
    }

    // Remove any existing injected news div
    const existingNewsDiv = document.getElementById('custom-news-content');
    if (existingNewsDiv) {
      existingNewsDiv.remove();
    }
    // Add a new div with custom text
    if (listArea) {
      const topListsDiv = document.querySelector('.top-lists');
      if (topListsDiv) {
        topListsDiv.style.display = 'none';
      }
      const topicListBottom = document.querySelector('.topic-list-bottom');
      if (topicListBottom) {
        topicListBottom.style.display = 'none';
      }
      const newsDiv = document.createElement('div');
      newsDiv.id = 'custom-news-content';
      newsDiv.style.padding = '2em';
      newsDiv.style.background = '#f9f9f9';
      newsDiv.innerHTML = '<h2>Dynamic News</h2><p>This is some dynamically injected news content.</p>';
      listArea.appendChild(newsDiv);
      console.log("Injected custom news content");
    }
  }



  // Attach click event to News tab to hide topic list and show news content
  api.onPageChange(() => {
    const newsTab = document.querySelector('.nav-item_news');
    if (newsTab) {
      newsTab.onclick = function(e) {
        log.log("[News Tab Theme] News tab clicked, toggling news content");
        e.preventDefault();
        toggleNewsContent();
        // Remove 'active' class from all nav items
        document.querySelectorAll('.navigation-bar .nav-item').forEach(item => {
          item.classList.remove('active');
        });
        // Add 'active' class to News tab
        newsTab.classList.add('active');
      };
    }

    document.querySelectorAll('.navigation-bar .nav-item:not(.nav-item_news)').forEach(tab => {
      tab.onclick = function(e) {
        log.log("[News Tab Theme] Non-news tab clicked, restoring topic list");
        // Remove custom news content if present
        const existingNewsDiv = document.getElementById('custom-news-content');
        if (existingNewsDiv) {
          existingNewsDiv.remove();
        }
        // Restore hidden elements
        const topTab = document.querySelector('.nav-item_top');
        if (topTab) {
          topTab.style.display = '';
        }
        const topListsDiv = document.querySelector('.top-lists');
        if (topListsDiv) {
          topListsDiv.style.display = '';
        }
        const topicListBottom = document.querySelector('.topic-list-bottom');
        if (topicListBottom) {
          topicListBottom.style.display = '';
        }
      };
    });

  });
</script>
