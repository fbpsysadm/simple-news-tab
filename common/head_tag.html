<script type="text/discourse-plugin" version="0.8.42">
  console.log("[News Tab Theme] Script loaded");
  // Add a new News tab to the navigation bar, linking to /top#news
  api.addNavigationBarItem({
    name: "news",
    displayName: "News",
    href: "/top#news"
  });

  // Function to show/hide news content and topic list
  function toggleNewsContent() {
    console.log("[News Tab Theme] toggleNewsContent called");
    const topicList = document.querySelector('.topic-list');
    const newsContent = document.querySelector('.custom-news-content');
    console.log("Hiding topic list, showing news content");
    topicList.style.display = 'none';
    newsContent.style.display = 'block';
    }
  }


  // Ensure clicking the News tab hides the topic list if visible
  api.onPageChange(() => {
    const newsTab = document.querySelector('.navigation-bar .news');
    if (newsTab) {
      console.log("found NewsTab");
      newsTab.onclick = function(e) {
        e.preventDefault();
        // Hide the topic list table if visible
        const topicList = document.querySelector('.topic-list');
        if (topicList && topicList.offsetParent !== null) {
          topicList.style.display = 'none';
        }
        // Optionally, show your news content if needed
        const newsContent = document.querySelector('.custom-news-content');
        if (newsContent) {
          newsContent.style.display = 'block';
        }
        // Optionally, update the hash for consistency
        if (window.location.pathname === '/top' || window.location.pathname === '/top/') {
          window.location.hash = '#news';
        } else {
          window.location.href = '/top#news';
        }
      };
    }
  });

  // Use MutationObserver to watch for topic list or news content being added
  const observer = new MutationObserver(() => {
    toggleNewsContent();
  });
  observer.observe(document.body, { childList: true, subtree: true });

  // Call once on load
  toggleNewsContent();
</script>
