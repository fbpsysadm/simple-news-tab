<script type="text/discourse-plugin" version="0.8.42">
  console.log("[News Tab Theme] Script loaded");
  // Add a new News tab to the navigation bar, linking to /top#news
  api.addNavigationBarItem({
    name: "news",
    displayName: "News",
    href: "/top#news"
  });

  // Function to show/hide news content and topic list
  function toggleNewsContent() {
    console.log("[News Tab Theme] toggleNewsContent called");
    const path = window.location.pathname;
    const hash = window.location.hash;
    console.log("Current path:", path, "Current hash:", hash);
    const isNewsTab = (path === "/top" || path === "/top/") && hash === "#news";
    const topicList = document.querySelector('.topic-list');
    const newsContent = document.querySelector('.custom-news-content');

    if (isNewsTab) {
      console.log("isNewsTab is true");
    } else {
      console.log("isNewsTab is false");
    }

    if (topicList) console.log("topicList found");
    if (newsContent) console.log("newsContent found");

    if (topicList && newsContent) {
      if (isNewsTab) {
        console.log("Hiding topic list, showing news content");
        topicList.style.display = 'none';
        newsContent.style.display = 'block';
      } else {
        console.log("Showing topic list, hiding news content");
        topicList.style.display = '';
        newsContent.style.display = 'none';
      }
    }
  }

  // Run on page change
  try {
    api.onPageChange(toggleNewsContent);
    console.log("[News Tab Theme] Registered toggleNewsContent with onPageChange");
  } catch (e) {
    console.error("[News Tab Theme] Error registering onPageChange:", e);
  }

  // Use MutationObserver to watch for topic list or news content being added
  const observer = new MutationObserver(() => {
    toggleNewsContent();
  });
  observer.observe(document.body, { childList: true, subtree: true });

  // Call once on load
  toggleNewsContent();
</script>
